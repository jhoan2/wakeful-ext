(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8581:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(8976)}])},8976:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return B}});var r=n(4051),o=n.n(r),u=n(5893),a=n(7294),i=n(6885),c=n(5350),s=n(7887),l=n(319);function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function f(e,t,n,r,o,u,a){try{var i=e[u](a),c=i.value}catch(s){return void n(s)}i.done?t(c):Promise.resolve(c).then(r,o)}function p(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var u=e.apply(t,n);function a(e){f(u,r,o,a,i,"next",e)}function i(e){f(u,r,o,a,i,"throw",e)}a(void 0)}))}}function h(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,u=[],a=!0,i=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(u.push(r.value),!t||u.length!==t);a=!0);}catch(c){i=!0,o=c}finally{try{a||null==n.return||n.return()}finally{if(i)throw o}}return u}}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return d(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function m(){var e=v(["\n    mutation UPDATE_NOTE($input: UpdateCardInput!) {\n        updateCard(input: $input) {\n          document {\n            id\n            annotation\n          }\n        }\n      }"]);return m=function(){return e},e}function g(){var e=v(['\n      query GET_CARDS_PER_URL {\n          icarusResourceIndex(\n            first: 1\n            filters: {where: {url: {equalTo: "','"}}}\n          ) {\n            edges {\n              node {\n                title\n                cards(\n                  first: 10\n                  filters: {where: {deleted: {equalTo: false}}}\n                ) {\n                  edges {\n                    node {\n                      id\n                      pageYOffset\n                      resourceId\n                      quote\n                      annotation\n                    }\n                  }\n                }\n              }\n            }\n          }\n      }']);return g=function(){return e},e}function b(e){var t=e.content,n=e.currentTab,r=function(e,t){var n=document.body.scrollHeight;if(t!==n){var r=e/t*n-20;window.scrollTo(0,r)}else e-=20,window.scrollTo(0,e)},i=(0,a.useState)(!1),s=i[0],d=i[1],f=(0,a.useState)(""),v=f[0],b=f[1],x=t.node,y=x.id,w=x.quote,j=x.annotation,S=x.pageYOffset,I=x.scrollHeight,k=n.id,N=n.url,C=(0,c.Ps)(m()),A=(0,c.Ps)(g(),N),O=h((0,l.D)(C,{onCompleted:function(){return d(!1)}}),2),T=O[0],_=O[1],P=(_.data,_.loading),E=_.error,L=h((0,l.D)(C,{onCompleted:function(){return d(!1)},refetchQueries:[{query:A}]}),2),R=L[0],q=L[1],D=(q.data,q.loading,q.error,function(){var e=p(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T({variables:{input:{id:y,content:{updatedAt:(new Date).toISOString(),annotation:v}}}});case 2:b("");case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()),B=function(){var e=p(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,R({variables:{input:{id:y,content:{updatedAt:(new Date).toISOString(),deleted:!0}}}});case 2:b("");case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),H=function(){var e=p(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,chrome.scripting.executeScript({target:{tabId:k},func:r,args:[S,I]});case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return P?"Submitting...":E?"Submission error! ".concat(E.message):w||j?(0,u.jsxs)("div",{className:"border-2 rounded relative p-6",children:[(0,u.jsx)("button",{className:"absolute top-0 right-1 text-red-300 hover:bg-red-600 rounded-md p-1",onClick:function(){return B()},children:"X"}),(0,u.jsx)("button",{className:"absolute bottom-0 left-1 hover:bg-gray-600 rounded-md p-1",onClick:function(){s?(d(!1),document.getElementById("update-note".concat(y)).classList.remove("hidden")):(document.getElementById("update-note".concat(y)).classList.add("hidden"),d(!0))},children:s?(0,u.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",className:"w-3.5 h-3.5 text-gray-300",children:(0,u.jsx)("path",{d:"M12.9999 16.1716L18.3638 10.8076L19.778 12.2218L11.9999 20L4.22168 12.2218L5.63589 10.8076L10.9999 16.1716V4H12.9999V16.1716Z"})}):(0,u.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",className:"w-3.5 h-3.5 text-gray-300",children:(0,u.jsx)("path",{d:"M12.9999 7.82843V20H10.9999V7.82843L5.63589 13.1924L4.22168 11.7782L11.9999 4L19.778 11.7782L18.3638 13.1924L12.9999 7.82843Z"})})}),(0,u.jsx)("p",{className:"italic border rounded p-2 hover:bg-gray-100",onClick:function(){return H()},children:w}),j?(0,u.jsx)("p",{className:"pt-2",children:j}):null,(0,u.jsxs)("div",{id:"update-note".concat(y),className:"flex flex-col pt-2 hidden",children:[(0,u.jsx)("label",{children:(0,u.jsx)("textarea",{placeholder:"Add Note Here",className:"w-full h-12",value:v,onChange:function(e){return b(e.target.value)}})}),(0,u.jsx)("div",{className:"flex justify-end",children:(0,u.jsx)("button",{onClick:function(){return D()},className:"py-3 px-4 inline-flex justify-center items-center gap-2 rounded-md border border-transparent font-semibold bg-blue-500 text-white hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-all text-sm dark:focus:ring-offset-gray-800",children:"Save"})})]})]}):null}function x(e){var t=e.data,n=e.currentTab;if(t&&!t.node.cards)return null;var r=t.node.cards.edges;return(0,u.jsx)("div",{className:"m-2",children:r.map((function(e){return(0,u.jsx)(b,{currentTab:n,content:e},e.node.id)}))})}function y(){var e,t,n=(e=['\n  query GET_CARDS_PER_URL {\n      icarusResourceIndex(\n        first: 1\n        filters: {where: {url: {equalTo: "','"}}}\n      ) {\n        edges {\n          node {\n            title\n            cards(\n              first: 10\n              filters: {where: {deleted: {equalTo: false}}}\n            ) {\n              edges {\n                node {\n                  id\n                  resourceId\n                  quote\n                  annotation\n                  pageYOffset\n                  scrollHeight\n                }\n              }\n            }\n          }\n        }\n      }\n    }'],t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}})));return y=function(){return n},n}function w(e){var t,n,r=e.currentTab,o=e.setCurrentResourceId,a=r.url,i=(0,c.Ps)(y(),a),l=(0,s.a)(i,{skip:!a}),d=l.loading,f=l.error,p=l.data;if(d)return(0,u.jsx)("p",{children:"Loading..."});if(f)return(0,u.jsxs)("p",{children:["Error : ",f.message]});p&&o(null===(n=null===(t=p.icarusResourceIndex.edges[0])||void 0===t?void 0:t.node.cards.edges[0])||void 0===n?void 0:n.node.resourceId);return(0,u.jsx)("div",{className:"dark:text-white",children:p?(0,u.jsx)(x,{data:p.icarusResourceIndex.edges[0],currentTab:r}):null})}function j(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function S(e,t,n,r,o,u,a){try{var i=e[u](a),c=i.value}catch(s){return void n(s)}i.done?t(c):Promise.resolve(c).then(r,o)}function I(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var u=e.apply(t,n);function a(e){S(u,r,o,a,i,"next",e)}function i(e){S(u,r,o,a,i,"throw",e)}a(void 0)}))}}function k(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,u=[],a=!0,i=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(u.push(r.value),!t||u.length!==t);a=!0);}catch(c){i=!0,o=c}finally{try{a||null==n.return||n.return()}finally{if(i)throw o}}return u}}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return j(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return j(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function N(){var e,t,n=(e=["\n    mutation ADD_NOTE($input: CreateCardInput!) {\n        createCard(input: $input) {\n          document {\n            id\n          }\n        }\n      }"],t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}})));return N=function(){return n},n}function C(e){var t=e.currentResourceId,n=e.currentTabId,r=e.setOpenAddNote,i=function(){return window.scrollY},s=(0,a.useState)(""),d=s[0],f=s[1],p=(new Date).toISOString(),h=function(){var e=I(o().mark((function e(){var t,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,chrome.scripting.executeScript({target:{tabId:n},func:i});case 2:return t=e.sent,r=t[0].result,r=parseInt(r),e.abrupt("return",r);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),v=(0,c.Ps)(N()),m=k((0,l.D)(v,{variables:{input:{content:{pageYOffset:I(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))}}},onCompleted:function(){return r(!1)}}),2),g=m[0],b=m[1],x=(b.data,b.loading),y=b.error;if(x)return"Submitting...";if(y)return"Submission error! ".concat(y.message);var w=function(){var e=I(o().mark((function e(){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h();case 2:n=e.sent,g({variables:{input:{content:{createdAt:p,updatedAt:p,resourceId:t,annotation:d,pageYOffset:n}}}}),f(""),r(!1);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,u.jsxs)("div",{className:"flex flex-col pt-2",children:[(0,u.jsx)("label",{children:(0,u.jsx)("textarea",{placeholder:"Add Note Here",className:"w-full h-12",value:d,onChange:function(e){return f(e.target.value)}})}),(0,u.jsx)("div",{className:"flex justify-end",children:(0,u.jsx)("button",{onClick:function(){return w()},className:"py-3 px-4 inline-flex justify-center items-center gap-2 rounded-md border border-transparent font-semibold bg-blue-500 text-white hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-all text-sm dark:focus:ring-offset-gray-800",children:"Save"})})]})}function A(e,t,n,r,o,u,a){try{var i=e[u](a),c=i.value}catch(s){return void n(s)}i.done?t(c):Promise.resolve(c).then(r,o)}function O(e){var t=e.styles,n=e.currentTabId,r=e.subtitles,a=function(e){var t=document.querySelector(".html5-main-video");t&&(t.currentTime=e)},i=function(){var e,t=(e=o().mark((function e(t){var r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.start,console.log(r),e.next=4,chrome.scripting.executeScript({target:{tabId:n},func:a,args:[r]});case 4:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,o){var u=e.apply(t,n);function a(e){A(u,r,o,a,i,"next",e)}function i(e){A(u,r,o,a,i,"throw",e)}a(void 0)}))});return function(e){return t.apply(this,arguments)}}();return(0,u.jsx)("div",{children:r.map((function(e){return(0,u.jsx)("div",{className:t,onClick:function(){return i(e)},children:e.text},e.start)}))})}function T(){return(0,u.jsx)("div",{children:"YoutubeNotes"})}n(4394);function _(e,t,n,r,o,u,a){try{var i=e[u](a),c=i.value}catch(s){return void n(s)}i.done?t(c):Promise.resolve(c).then(r,o)}function P(e){var t=e.currentTab,n=e.youtubeId,r=(0,a.useState)(!1),i=r[0],c=r[1],s=t.id,l=(0,a.useState)("p-2 m-2 border border-gray-300 rounded-lg hover:bg-gray-100"),d=l[0],f=(l[1],n),p=(0,a.useState)([{start:"1.079",dur:"5.7",text:"so uh let's try to Define some more"},{start:"3.84",dur:"5.04",text:"terms um in in the way I typically"},{start:"6.779",dur:"3.961",text:"disassemble things I treat the mind as"}]),h=p[0],v=(p[1],(0,a.useState)("&quot;Joscha Bach Bits&quot; features short videos of Joscha Bach&#39;s ideas, opinions, and perspectives on various topics, edited from interviews. #JoschaBachBits #Philo...")),m=(v[0],v[1],function(){var e,t=(e=o().mark((function e(t){var n=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.length>1&&void 0!==n[1]&&n[1],console.log("video");case 2:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,o){var u=e.apply(t,n);function a(e){_(u,r,o,a,i,"next",e)}function i(e){_(u,r,o,a,i,"throw",e)}a(void 0)}))});return function(e){return t.apply(this,arguments)}}());return(0,a.useEffect)((function(){m(f,"en")}),[]),(0,u.jsxs)("div",{id:"subtitle-container",children:[(0,u.jsx)("button",{onClick:function(){return injectScript(s)},children:"Sync Video"}),(0,u.jsx)("button",{onClick:function(){return changeStyles()},children:"Add styles"}),(0,u.jsx)("button",{onClick:function(){return c(!i)},children:i?"Captions":"Notes"}),i?(0,u.jsx)(T,{}):(0,u.jsx)(O,{subtitles:h,styles:d,currentTabId:t.id})]})}var E=n(4329);function L(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function R(e,t,n,r,o,u,a){try{var i=e[u](a),c=i.value}catch(s){return void n(s)}i.done?t(c):Promise.resolve(c).then(r,o)}function q(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var u=e.apply(t,n);function a(e){R(u,r,o,a,i,"next",e)}function i(e){R(u,r,o,a,i,"throw",e)}a(void 0)}))}}function D(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,u=[],a=!0,i=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(u.push(r.value),!t||u.length!==t);a=!0);}catch(c){i=!0,o=c}finally{try{a||null==n.return||n.return()}finally{if(i)throw o}}return u}}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return L(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return L(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var B=function(e){e.loggedIn;var t=(0,i.c)(),n=(t.ceramic,t.composeClient,(0,a.useState)({})),r=n[0],c=n[1],s=(0,a.useState)(""),l=s[0],d=s[1],f=(0,a.useState)(""),p=f[0],h=f[1],v=(0,a.useState)(!1),m=v[0],g=v[1],b=function(){var e=q(o().mark((function e(){var t,n,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={active:!0,lastFocusedWindow:!0},e.t0=D,e.next=4,chrome.tabs.query(t);case 4:return e.t1=e.sent,n=(0,e.t0)(e.t1,1),r=n[0],e.abrupt("return",r);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),x=function(){var e=q(o().mark((function e(){var t,n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b();case 2:t=e.sent,c(t),(n=(0,E.Z)(t.url).id)&&h(n);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,a.useEffect)((function(){x()}),[]),(0,u.jsxs)("div",{className:"dark:bg-gray-800 h-screen",children:[(0,u.jsxs)("div",{className:"dark:text-white flex space-x-4",children:[(0,u.jsx)("button",{onClick:function(){return g(!m)},children:"Add Note"}),(0,u.jsx)("button",{onClick:function(){window.location.reload()},children:"Refresh"}),(0,u.jsx)("button",{onClick:function(){return"dark"===localStorage.getItem("theme")?localStorage.removeItem("theme"):localStorage.setItem("theme","dark"),void window.location.reload()},children:"Dark Mode"}),(0,u.jsx)("button",{onClick:function(){return localStorage.setItem("logged_in","false"),localStorage.removeItem("ceramic:did_seed"),localStorage.removeItem("ceramic:eth_did"),localStorage.removeItem("did"),localStorage.removeItem("ceramic:auth_type"),window.location.reload(),void console.log("logged out")},children:"Logout"})]}),m?(0,u.jsx)("div",{className:"border-2 rounded relative p-6 m-2",children:(0,u.jsx)(C,{currentResourceId:l,currentTabId:r.id,setOpenAddNote:g})}):null,p?(0,u.jsx)(P,{currentTab:r,youtubeId:p}):(0,u.jsx)(w,{currentTab:r,setCurrentResourceId:d})]})}}},function(e){e.O(0,[717,774,888,179],(function(){return t=8581,e(e.s=t);var t}));var t=e.O();_N_E=t}]);